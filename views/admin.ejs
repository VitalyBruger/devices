<script>
 function deleteSend(id){
    var xhr = new XMLHttpRequest();   
    xhr.open("DELETE", '/admin/delete/'+id, true)
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')

    xhr.onreadystatechange = function() {
        if (this.readyState != 4) return;
        //document.write(this.responseText);
        window.location.href='/admin';
    }

    xhr.send();    
}

function freeSend(id){    
    if (id == 0) return;
    var xhr = new XMLHttpRequest();   
    xhr.open("PUT", '/admin/free/'+id, true)
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')
    xhr.onreadystatechange = function() {
        if (this.readyState != 4) return;
        //document.write(this.responseText);
        window.location.href='/admin';
    }
    xhr.send();    
}
</script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">

    <div class="container">
        <div class="row">
            <h1>Пристрої</h1>
            <br>
            <table class="table table-striped">
            <tr>
                <th>№</th>
                <th>Пристрій</th>
                <th>Інвентарний номер</th>
                <th>Дата видачі</th>
                <th>Дата повернення</th>
                <th>Хто взяв</th>
                <th>Дії</th>
            </tr>
                               
                <% if(data.length){                                 
                 for(var i = 0;i < data.length;i++) 

                 { 
                 if (data[i].returndate == ""  && data[i].owner == "") {%>
                <tr class="success">

                <%} else {%>

                <tr class="danger">
                <%}%>
                    <td><%=(i+1)%></td>
                    <td><%=data[i].devicename%></td>
                    <td><%=data[i].devicenumber%></td>
                    <td><%=data[i].tookdate%></td>
                    <td><%=data[i].returndate%></td>
                    <td><%=data[i].owner%></td>
                     <td>

                        
                        <%if (data[i].returndate == ""  && data[i].owner == "") {%>
                        <button type="button"class="btn btn-success disabled" 
                            onClick="freeSend(0)">Повернути</button>
                        <%} else {%>
                            <button type="button"class="btn btn-success " 
                            onClick="freeSend(<%=data[i].id%>)">Повернути</button>

                        <%}%>
                        <button type="button"class="btn btn-warning" onClick="window.location.href='../admin/edit/<%=data[i].id%>'">Редагувати</button>
                        <button type="button"class="btn btn-danger" onClick="deleteSend(<%=data[i].id%>)">Видалити
                        </button>
                        <button type="button"class="btn btn-info" onClick="window.location.href='../admin/history/<%=data[i].id%>'">Історія
                        </button>

                    </td>
                </tr>
            <% } } %>
            </table>
        </div>
        <div class="row">
            <button type="button"class="btn btn-success" onClick="window.location.href='../admin/add'">Додати пристрій</button>
            <button type="button"class="btn btn-info" onClick="window.location.href='../admin/load'">Вивантажити протокол</button>

            <button type="button"class="btn btn-primary" onClick="window.location.href='../admin/changepas'">Змінити пароль</button>
             
        </div>


    </div>
        

